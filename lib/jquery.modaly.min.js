/*!
 * jQuery Modaly - A Modal Plugin
 *
 * Licensed under The MIT License
 *
 * @version        0.1.0
 * @author         Washington Botelho
 * @documentation  wbotelhos.com/modaly
 *
 */

;(function(b){var a={init:function(c){return this.each(function(){this.opt=b.extend({},b.fn.modaly.defaults,c);this.overlay=a._overlay.call(this);this.modal=a._modal.call(this);this.close=a._closeButton.call(this);a._bind.call(this);b(this).data({block:this.opt.block?true:false,modaly:true,settings:this.opt});});},_bind:function(){var d=this,c=b(d);d.close.on("click.modaly",function(){a._close.call(d);});if(d.opt.closeOverlay){d.overlay.on("click.modaly",function(){a._close.call(d);});}c.on("click.modaly",function(f){f.preventDefault();if(!c.data("block")){a._open.call(d);}});if(d.opt.esc){b(document).on("keyup.modaly",function(g){var f=g.keyCode||g.which;if(f===27){a._close.call(d);}});}},_close:function(){if(this.modal.data("opened")){a._hide.call(this,this.modal);a._hide.call(this,this.overlay);}},_closeButton:function(){var c=this.modal.find(this.opt.closeTarget);if(!this.opt.closeButton){c.hide();}return c;},_hide:function(c){c.data("opened",false).fadeTo(this.opt.speed,0,function(){this.style.display="none";});},_modal:function(){var c=b(this.getAttribute("href")).data("opened",false).addClass("modaly");return c.css({position:"fixed","z-index":11000});},_open:function(){if(!this.modal.data("opened")){this.modal.css({left:50+"%","margin-left":-(this.modal.outerWidth()/2)+"px",top:this.opt.top+"px"});a._show.call(this,this.modal,1);a._show.call(this,this.overlay,this.opt.overlay);}},_overlay:function(){var c=b("#modaly-overlay");if(c.length===0){c=b("<div />",{id:"modaly-overlay"});}return c.appendTo("body");},_show:function(d,c){d.data("opened",true).css({opacity:0}).fadeTo(this.opt.speed,c);},block:function(c){return this.each(function(){this.modal.data("block",c?true:false);});},close:function(){return this.each(function(){a._close.call(this);});},open:function(){return this.each(function(){a._open.call(this);});}};b.fn.modaly=function(c){if(a[c]){return a[c].apply(this,Array.prototype.slice.call(arguments,1));}else{if(typeof c==="object"||!c){return a.init.apply(this,arguments);}else{b.error("Method "+c+" does not exist!");}}};b.fn.modaly.defaults={block:false,closeButton:true,closeOverlay:true,closeTarget:".modaly-close",esc:true,overlay:0.5,speed:200,top:100};})(jQuery);
